{"remainingRequest":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/src/views/Transfer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/src/views/Transfer.vue","mtime":1583121267803},{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/arcadiopobletetorres/Documents/desarrollo/anglobal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAnLi4vY29tcG9uZW50cy9IZWFkZXInCmltcG9ydCBUYWJsYSBmcm9tICcuLi9jb21wb25lbnRzL1RhYmxhJwppbXBvcnQgY2hhclBpZSBmcm9tICcuLi9jb21wb25lbnRzL0NoYXJ0JwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6ICgpID0+ICh7CiAgICBzZWxlY3Q6IFtdLAogICAgbW9udG86ICcnLAogICAgYWxlcnQ6ewogICAgICBhY3RpdmU6IGZhbHNlLAogICAgICBjb2xvcjogJycsCiAgICAgIHRleHQ6ICcnCiAgICB9LAogICAgbG9hZGVkOiBmYWxzZSwKICB9KSwKICBjcmVhdGVkICgpewoKICAvLy8vLy8vLy8vLy8gQ3VlbnRhcwogICAgYXhpb3MuZ2V0KCcuLi9kYXRhYmFzZS9hY2NvdW50cy5qc29uJykKICAgICAgLnRoZW4oaXRlbSA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5jdWVudGFzID0gaXRlbS5kYXRhLmFjY291bnRzCiAgICAgIH0pLmNhdGNoKGVyciA9PiAgIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgIH0pCgogLy8vLy8vLy8vLy8vIFNlbGVjdG9yIGN1ZW50YXMgIAogICAgICB0aGlzLnNlbGVjdCA9IHRoaXMuJHN0b3JlLnN0YXRlLmN1ZW50YXMubWFwKGl0ZW0gPT4gewogICAgICAgICAgcmV0dXJuewogICAgICAgICAgICAgIHRleHQ6ICcqKioqJyArIFN0cmluZyhpdGVtLmFjY291bnQpLnN1YnN0cig1LDkpICsgJyAtICcgKyBpdGVtLm1vbmV5LmN1cnJlbmN5ICsgaXRlbS5tb25leS52YWx1ZSwKICAgICAgICAgICAgICB2YWx1ZTogaXRlbS5hY2NvdW50CiAgICAgICAgICB9CiAgICAgIH0pCgogIC8vLy8vLy8vLy8vIE9idGVuZXIgdHJhbnNhY2Npw7NuZXMKICAgIGF4aW9zLmdldCgnLi4vZGF0YWJhc2UvdHJhbnNhY2N0aW9ucy5qc29uJykKICAgICAgLnRoZW4oaXRlbSA9PiB7CiAgICAgICAgbGV0IGRhdG9zID0gaXRlbS5kYXRhLnRyYW5zYWN0aW9ucwogICAgICAgCiAgICAgICAgbGV0IGdydXBvcyA9IGRhdG9zLnJlZHVjZSgoY29udCwgaXRlbSkgPT4geyAgCiAgICAgICAgICAgICAgY29udFtpdGVtLmZyb21BY2NvdW50XSA9IGNvbnRbaXRlbS5mcm9tQWNjb3VudF0gfHwgW10KICAgICAgICAgICAgICBjb250W2l0ZW0uZnJvbUFjY291bnRdLnB1c2goaXRlbSkKICAgICAgICAgICAgICByZXR1cm4gY29udCAgfSx7fSkKICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgfSkKICB9LAogIG1ldGhvZHM6IHsKLy8vLy8vLy8vLyBBZ3JlZ2FyIGRhdG9zIGEgbGFzIHRhYmxhcyAgCiAgICAgIG5ld1RyYW5zZmVyKCl7CgogICAgICAvLy8vLy8vLy8vLy8vIE1vZGVsbyBkZSBkYXRvcwogICAgICAgIGxldCBuZXdJdGVtID0gewogICAgICAgICAgICAgICAgZnJvbUFjY291bnQ6IHRoaXMuJHN0b3JlLnN0YXRlLnRyYW5zZmVyLmZyb21BY2NvdW50LAogICAgICAgICAgICAgICAgdG9BY2NvdW50OiB0aGlzLiRzdG9yZS5zdGF0ZS50cmFuc2Zlci50b0FjY291bnQsCiAgICAgICAgICAgICAgICBhbW91bnQ6IHsKICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICcnLAogICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy4kc3RvcmUuc3RhdGUudHJhbnNmZXIuYW1vdW50LnZhbHVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc2VudEF0OiBEYXRlKCkKICAgICAgICAgIH0KCiAgICAgIC8vLy8vLy8vLy8gVmFsaWRhY2nDs24gZGUgbGEgY3VlbnRhCiAgICAgICAgICBpZih0aGlzLiRzdG9yZS5zdGF0ZS50cmFuc2Zlci5mcm9tQWNjb3VudCA9PSBudWxsKXsKICAgICAgICAgICAgICAKICAgICAgICAgICAgICB0aGlzLmFsZXJ0LmFjdGl2ZSA9IHRydWUKICAgICAgICAgICAgICB0aGlzLmFsZXJ0LmNvbG9yID0gJ3JlZCBkYXJrZW4tNCcKICAgICAgICAgICAgICB0aGlzLmFsZXJ0LnRleHQgPSAnRWwgY2FtcG8gY3VlbnRhIGVzdGEgdmFjaW8nCiAgICAgIAogICAgICAvLy8vLy8vLy8vIFZhbGlkYWNpw7NuIGRlbCBjYW1wbyBkZXN0aW5vCiAgICAgICAgICB9ZWxzZSBpZiAodGhpcy4kc3RvcmUuc3RhdGUudHJhbnNmZXIudG9BY2NvdW50ID09IG51bGwpewogICAgICAgICAgICAgIAogICAgICAgICAgICAgIHRoaXMuYWxlcnQuYWN0aXZlID0gdHJ1ZQogICAgICAgICAgICAgIHRoaXMuYWxlcnQuY29sb3IgPSAncmVkIGRhcmtlbi00JwogICAgICAgICAgICAgIHRoaXMuYWxlcnQudGV4dCA9ICdFbCBjYW1wbyBkZXN0aW5vIGVzdGEgdmFjaW8nCiAgICAgIAogICAgICAvLy8vLy8vLy8vIFZhbGlkYWNpw7NuIGRlbCBtb250bwogICAgICAgICAgfWVsc2UgaWYodGhpcy4kc3RvcmUuc3RhdGUudHJhbnNmZXIuYW1vdW50LnZhbHVlID09IG51bGwpewogICAgICAgICAgICAgIAogICAgICAgICAgICAgIHRoaXMuYWxlcnQuYWN0aXZlID0gdHJ1ZQogICAgICAgICAgICAgIHRoaXMuYWxlcnQuY29sb3IgPSAncmVkIGRhcmtlbi00JwogICAgICAgICAgICAgIHRoaXMuYWxlcnQudGV4dCA9ICdFbCBtb250byBlc3RhIHZhY2lvJwoKICAgICAgICAgIH1lbHNlIHsgICAgICAgICAgICAKICAgICAgCiAgICAgIC8vLy8vLy8vLyBTZSBhZ3JlZ2FuIGxvcyBkYXRvcyBhIGxhIGN1ZW50YQogICAgICAgICAgICBheGlvcy5nZXQoJy4uL2RhdGFiYXNlL2FjY291bnRzLmpzb24nKQogICAgICAgICAgICAgIC50aGVuKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgbGV0IGRhdG9zID0gaXRlbS5kYXRhLmFjY291bnRzCiAgICAgICAgICAgICAgICAKICAgICAgLy8vLy8vLy8vIFNlIGJ1c2FjYSBlbCB2YWxvciBkZSBsYSBtb25lZGEKICAgICAgICAgICAgICAgIGxldCBjdWVudGFzID0gZGF0b3MucmVkdWNlKChhY2MsIGl0ZW0pID0+IHsKICAgICAgICAgICAgICAgICAgICAgIGFjY1tpdGVtLmFjY291bnRdID0gYWNjW2l0ZW0uYWNjb3VudF0gfHwgW10KICAgICAgICAgICAgICAgICAgICAgIGFjY1tpdGVtLmFjY291bnRdLnB1c2goaXRlbS5tb25leS5jdXJyZW5jeSkKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY2MKICAgICAgICAgICAgICAgIH0sT2JqZWN0LmNyZWF0ZShudWxsKSkKICAgICAgCiAgICAgIC8vLy8vLy8vLyBTZSB2YWxpZGEgcXVlIGxhIGN1ZW50YSB0ZW5nYSBzYWxkbyBzdWZ1Y3VlbnRlCiAgICAgICAgICAgICAgICBsZXQgbW9udG9DdWVudGEgPSBkYXRvcy5maWx0ZXIoaXRlbSA9PiBpdGVtLmFjY291bnQgPT0gbmV3SXRlbS5mcm9tQWNjb3VudCkKICAgICAgICAgICAgICAgICAgICAgIC5tYXAoaXRlbSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLm1vbmV5LnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgaWYobmV3SXRlbS5hbW91bnQudmFsdWUgPiBwYXJzZUludChtb250b0N1ZW50YSkpewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGVydC5hY3RpdmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0LnRleHQgPSAnTGEgY3VlbnRhIG5vdGllbiBzdWZ1Y3VlbnRlIHNhbGRvJwogICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGVydC5jb2xvciA9ICdhbWJlciBkYXJrZW4tMicKICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIC8vLy8vLy8vLy8gU2kgY3VtcGxlIGNvbiBlbG1vbnRvIHNlIGFjZXB0YSBsYSB0cmFuc2ZlcmVuY2lhCiAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5hbW91bnQuY3VycmVuY3kgPSBTdHJpbmcoY3VlbnRhc1tuZXdJdGVtLmZyb21BY2NvdW50XSkKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmRhdGFUYWJsZVtuZXdJdGVtLmZyb21BY2NvdW50XS5wdXNoKG5ld0l0ZW0pKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmZvcm1UcmFuc2Zlci5yZXNldCgpCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPY3VycmlvIHVuIGVycm9yJykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiAgIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEhlYWRlciwKICAgIFRhYmxhLAogICAgY2hhclBpZQogIH0gCn0K"},{"version":3,"sources":["Transfer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Transfer.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <Header/>\n    <v-container class=\"mt-12\">\n      <v-row>\n        <v-col cols=\"4\" md=\"4\" lg=\"4\" xl=\"4\">\n             <v-card>\n              <!-- Titulo -->\n              <v-card-title class=\"headline light-blue darken-1 white--text\">\n                Create new transfer\n              </v-card-title>\n\n              <!-- Card Transfer -->\n              <v-card-text>\n                  <!-- Formulario -->\n                  <v-form ref=\"formTransfer\">\n                    <v-row>\n                        <!-- Select Cuentas -->\n                        <v-col cols=\"12\" class=\"pb-0\">\n                          <v-select  :items=\"select\" label=\"Accounts\" v-model=\"$store.state.transfer.fromAccount\"></v-select>\n                        </v-col> \n                        \n                        <!-- Destino -->\n                        <v-col cols=\"12\" class=\"pt-0 pb-0\">\n                          <v-text-field  label=\"Destination account\"  counter=\"8\" maxlength=\"8\" v-model=\"$store.state.transfer.toAccount\"></v-text-field>\n                        </v-col>\n                        \n                        <!-- Monto a transferir -->\n                        <v-col cols=\"12\" class=\"pt-0 pb-0\">\n                          <v-text-field label=\"Amount\" v-model=\"$store.state.transfer.amount.value\"></v-text-field>\n                        </v-col> \n                    </v-row>\n                  </v-form>\n              </v-card-text>\n\n              <v-divider></v-divider>\n\n              <!-- Acciones -->\n              <v-card-actions class=\"pa-0\">\n                <v-spacer></v-spacer>\n                    <!-- New transfer -->\n                    <v-btn color=\"green darken-3\" tile dark depressed class=\"btnTrans\" @click=\"newTransfer\">Transfer</v-btn>\n                    <!-- Cancel transfer -->\n                    <v-btn color=\"blue-grey lighten-4\" tile depressed @click=\"$refs.formTransfer.reset()\" class=\"btnTrans ml-0\">Cancel</v-btn>\n              </v-card-actions>\n\n                <!-- Alerta -->\n                <v-snackbar v-model=\"alert.active\" :color=\"alert.color\" top right>\n                    {{ alert.text }}\n                    <v-btn  text @click=\"alert.active = false\">Close</v-btn>\n                </v-snackbar>\n\n            </v-card>\n        </v-col>\n        \n        <!-- Componente grafica --------------->\n        <v-col cols=\"12\" md=\"8\" lg=\"8\" xl=\"8\" class=\"d-flex justify-center align-center\">\n          <char-pie></char-pie>\n        </v-col>\n        <!-- Componente grafica --------------->\n\n      </v-row>\n      <Tabla/>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport Header from '../components/Header'\nimport Tabla from '../components/Tabla'\nimport charPie from '../components/Chart'\n\nexport default {\n  data: () => ({\n    select: [],\n    monto: '',\n    alert:{\n      active: false,\n      color: '',\n      text: ''\n    },\n    loaded: false,\n  }),\n  created (){\n\n  //////////// Cuentas\n    axios.get('../database/accounts.json')\n      .then(item => {\n          this.$store.state.cuentas = item.data.accounts\n      }).catch(err =>   {\n        console.log(err)\n      })\n\n //////////// Selector cuentas  \n      this.select = this.$store.state.cuentas.map(item => {\n          return{\n              text: '****' + String(item.account).substr(5,9) + ' - ' + item.money.currency + item.money.value,\n              value: item.account\n          }\n      })\n\n  /////////// Obtener transacciónes\n    axios.get('../database/transacctions.json')\n      .then(item => {\n        let datos = item.data.transactions\n       \n        let grupos = datos.reduce((cont, item) => {  \n              cont[item.fromAccount] = cont[item.fromAccount] || []\n              cont[item.fromAccount].push(item)\n              return cont  },{})\n         }).catch(err => {\n          console.log(err)\n      })\n  },\n  methods: {\n////////// Agregar datos a las tablas  \n      newTransfer(){\n\n      ///////////// Modelo de datos\n        let newItem = {\n                fromAccount: this.$store.state.transfer.fromAccount,\n                toAccount: this.$store.state.transfer.toAccount,\n                amount: {\n                  currency: '',\n                  value: this.$store.state.transfer.amount.value\n                },\n                sentAt: Date()\n          }\n\n      ////////// Validación de la cuenta\n          if(this.$store.state.transfer.fromAccount == null){\n              \n              this.alert.active = true\n              this.alert.color = 'red darken-4'\n              this.alert.text = 'El campo cuenta esta vacio'\n      \n      ////////// Validación del campo destino\n          }else if (this.$store.state.transfer.toAccount == null){\n              \n              this.alert.active = true\n              this.alert.color = 'red darken-4'\n              this.alert.text = 'El campo destino esta vacio'\n      \n      ////////// Validación del monto\n          }else if(this.$store.state.transfer.amount.value == null){\n              \n              this.alert.active = true\n              this.alert.color = 'red darken-4'\n              this.alert.text = 'El monto esta vacio'\n\n          }else {            \n      \n      ///////// Se agregan los datos a la cuenta\n            axios.get('../database/accounts.json')\n              .then(item => {\n                let datos = item.data.accounts\n                \n      ///////// Se busaca el valor de la moneda\n                let cuentas = datos.reduce((acc, item) => {\n                      acc[item.account] = acc[item.account] || []\n                      acc[item.account].push(item.money.currency)\n                      return acc\n                },Object.create(null))\n      \n      ///////// Se valida que la cuenta tenga saldo sufucuente\n                let montoCuenta = datos.filter(item => item.account == newItem.fromAccount)\n                      .map(item => {\n                        return item.money.value\n                      })\n\n                  if(newItem.amount.value > parseInt(montoCuenta)){\n                      this.alert.active = true\n                      this.alert.text = 'La cuenta notien sufucuente saldo'\n                      this.alert.color = 'amber darken-2'\n                  }else{\n                     \n        ////////// Si cumple con elmonto se acepta la transferencia\n                    newItem.amount.currency = String(cuentas[newItem.fromAccount])\n\n                    if (this.$store.state.dataTable[newItem.fromAccount].push(newItem)) {\n                      this.$refs.formTransfer.reset()\n                    }else{\n                        console.log('Ocurrio un error')\n                    }\n                  }\n                }).catch(err =>   {\n                    console.log(err)\n                })\n          }\n        }\n  },\n  components: {\n    Header,\n    Tabla,\n    charPie\n  } \n}\n</script>"]}]}